ggplot(data = tmp_melt, aes(x = STATUS, y = value, fill = STATUS)) +
geom_boxplot(outlier.size = 0, alpha = 0.3) +
geom_point(pch = 21, position = position_jitterdodge()) + facet_wrap(. ~ variable) +
theme_bw() + scale_fill_manual(values=c("turquoise3", "tan3")) + theme(legend.position = "none")
ggplot(data = tmp_melt, aes(x = STATUS, y = value, fill = STATUS)) +
geom_boxplot(outlier.size = 0, alpha = 0.3) +
geom_point(pch = 21, position = position_jitterdodge()) + facet_wrap(. ~ variable, scales = "free_y") +
theme_bw() + scale_fill_manual(values=c("turquoise3", "tan3")) + theme(legend.position = "none")
ggplot(data = tmp_melt, aes(x = STATUS, y = log2(value), fill = STATUS)) +
geom_boxplot(outlier.size = 0, alpha = 0.3) +
geom_point(pch = 21, position = position_jitterdodge()) + facet_wrap(. ~ variable, scales = "free_y") +
theme_bw() + scale_fill_manual(values=c("turquoise3", "tan3")) + theme(legend.position = "none")
ggplot(data = tmp_melt, aes(x = STATUS, y = log2(value), fill = STATUS)) +
geom_boxplot(outlier.size = 0, alpha = 0.3) +
geom_point(pch = 21, position = position_jitterdodge()) + facet_wrap(. ~ variable, scales = "free_y") +
theme_bw() + scale_fill_manual(values=c("turquoise3", "tan3")) + theme(legend.position = "none")
ggplot(data = tmp_melt, aes(x = STATUS, y = value, fill = STATUS)) +
geom_boxplot(outlier.size = 0, alpha = 0.3) +
geom_point(pch = 21, position = position_jitterdodge()) + facet_wrap(. ~ variable, scales = "free_y") +
theme_bw() + scale_fill_manual(values=c("turquoise3", "tan3")) + theme(legend.position = "none")
# average out and check normality again
otu_average <- otu_merged %>% select(., Individual, STATUS, SUBSTATUS, 32:NCOL(otu_merged)) %>%
group_by(., Individual, STATUS, SUBSTATUS) %>% summarise_at(., vars(starts_with("k_")), mean)
tmp <- otu_average %>% select(., STATUS, `k__Bacteria;p__Firmicutes;c__Clostridia;o__Clostridiales;f__Veillonellaceae;g__Phascolarctobacterium;s__Phascolarctobacterium`,
`k__Bacteria;p__Firmicutes;c__Clostridia;o__Clostridiales;f__Veillonellaceae;g__Dialister;s__Dialister`)
tmp_melt <- melt(tmp)
ggplot(data = tmp_melt, aes(x = STATUS, y = value, fill = STATUS)) +
geom_boxplot(outlier.size = 0, alpha = 0.3) +
geom_point(pch = 21, position = position_jitterdodge()) + facet_wrap(. ~ variable, scales = "free_y") +
theme_bw() + scale_fill_manual(values=c("turquoise3", "tan3")) + theme(legend.position = "none")
ggplot(data = tmp_melt, aes(x = STATUS, y = log2(value), fill = STATUS)) +
geom_boxplot(outlier.size = 0, alpha = 0.3) +
geom_point(pch = 21, position = position_jitterdodge()) + facet_wrap(. ~ variable, scales = "free_y") +
theme_bw() + scale_fill_manual(values=c("turquoise3", "tan3")) + theme(legend.position = "none")
tmp <- otu_merged %>% select(., STATUS, `k__Bacteria;p__Firmicutes;c__Clostridia;o__Clostridiales;f__Veillonellaceae;g__Phascolarctobacterium;s__Phascolarctobacterium`,
`k__Bacteria;p__Firmicutes;c__Clostridia;o__Clostridiales;f__Veillonellaceae;g__Dialister;s__Dialister`)
tmp_melt <- melt(tmp)
ggplot(data = tmp_melt, aes(x = STATUS, y = value, fill = STATUS)) +
geom_boxplot(outlier.size = 0, alpha = 0.3) +
geom_point(pch = 21, position = position_jitterdodge()) + facet_wrap(. ~ variable, scales = "free_y") +
theme_bw() + scale_fill_manual(values=c("turquoise3", "tan3")) + theme(legend.position = "none")
ggplot(data = cyto_otu, aes(y = tn_fa, x = veillonella)) +
geom_point()
ggplot(data = cyto_otu, aes(y = dialister, x = phascolarctobacterium)) +
geom_point()
cyto_otu %>% select(., tn_fa, 16:86) %>%
corrr::correlate(method = "spearman") %>%
corrr::focus(phascolarctobacterium) %>%
filter(abs(phascolarctobacterium) > 0.1) %>%
#mutate(rowname = factor(rowname, levels = rowname[order(Fiber)])) %>%
ggplot(aes(x = rowname, y = phascolarctobacterium)) +
geom_bar(stat = "identity") +
ylab("Correlation (R) with Fiber\n (Spearman)") +
xlab("Species") + theme_bw() + theme(axis.text.x = element_text(angle = 90)) +
coord_flip()
cyto_otu %>% select(., tn_fa, 16:86) %>%
corrr::correlate(method = "spearman") %>%
corrr::focus(tn_fa) %>%
filter(abs(tn_fa) > 0.1) %>%
#mutate(rowname = factor(rowname, levels = rowname[order(Fiber)])) %>%
ggplot(aes(x = rowname, y = tn_fa)) +
geom_bar(stat = "identity") +
ylab("Correlation (R) with Fiber\n (Spearman)") +
xlab("Species") + theme_bw() + theme(axis.text.x = element_text(angle = 90)) +
coord_flip()
pheatmap(Lasso_data, show_rownames = T)
library(tidyverse)
library(corrplot)
library(pheatmap)
library(gflasso)
library(janitor)
library(viridis)
pheatmap(Lasso_data, show_rownames = T)
heatmap(Lasso_data, scale = "row", col=viridis(40), margins = c(4,15))
cyto_otu %>% select(., tn_fa, 16:86) %>%
corrr::correlate(method = "spearman") %>%
corrr::focus(tn_fa) %>%
filter(abs(tn_fa) > 0.1) %>%
#mutate(rowname = factor(rowname, levels = rowname[order(Fiber)])) %>%
ggplot(aes(x = rowname, y = tn_fa)) +
geom_bar(stat = "identity") +
ylab("Correlation (R) with Fiber\n (Spearman)") +
xlab("Species") + theme_bw() + theme(axis.text.x = element_text(angle = 90)) +
coord_flip()
cyto_otu %>% select(., tn_fa, 16:86) %>%
corrr::correlate(method = "pearson") %>%
corrr::focus(tn_fa) %>%
filter(abs(tn_fa) > 0.1) %>%
#mutate(rowname = factor(rowname, levels = rowname[order(Fiber)])) %>%
ggplot(aes(x = rowname, y = tn_fa)) +
geom_bar(stat = "identity") +
ylab("Correlation (R) with Fiber\n (Spearman)") +
xlab("Species") + theme_bw() + theme(axis.text.x = element_text(angle = 90)) +
coord_flip()
range(Lasso_data)
ggplot(data = cytokine_rfp_melt, aes(x = Status, y = log2(value))) +
geom_boxplot(aes(fill = Status), outlier.colour = "white") +
geom_jitter(width = 0.2, aes(alpha = 0.3, shape = Status)) +
facet_wrap(. ~ variable, scales = "free", nrow = 1) +
scale_fill_manual(values=c("turquoise3", "tan3")) +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA),
axis.text.y = element_blank(), axis.ticks.y = element_blank(),
axis.text.x = element_blank(), axis.ticks.x = element_blank(), panel.spacing = unit(-0.2, "lines"))
ggplot(data = cytokine_rfp_melt, aes(x = Status, y = log2(value))) +
geom_boxplot(aes(fill = Status), outlier.colour = "white") +
geom_jitter(width = 0.2, aes(alpha = 0.3, shape = Status)) +
facet_wrap(. ~ variable, nrow = 1) +
scale_fill_manual(values=c("turquoise3", "tan3")) +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA),
#axis.text.y = element_blank(), axis.ticks.y = element_blank(),
axis.text.x = element_blank(), axis.ticks.x = element_blank(), panel.spacing = unit(-0.2, "lines"))
ggplot(data = cytokine_rfp_melt, aes(x = Status, y = log2(value))) +
geom_boxplot(aes(fill = Status), outlier.colour = "white") +
geom_jitter(width = 0.2, aes(alpha = 0.3, shape = Status)) +
facet_wrap(. ~ variable, scales = "free", nrow = 1) +
scale_fill_manual(values=c("turquoise3", "tan3")) +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA),
#axis.text.y = element_blank(), axis.ticks.y = element_blank(),
axis.text.x = element_blank(), axis.ticks.x = element_blank(), panel.spacing = unit(-0.2, "lines"))
ggplot(data = cytokine_rfp_melt, aes(x = Status, y = log2(value))) +
geom_boxplot(aes(fill = Status), outlier.colour = "white") +
geom_jitter(width = 0.2, aes(alpha = 0.3, shape = Status)) +
facet_wrap(. ~ variable, nrow = 1) +
scale_fill_manual(values=c("turquoise3", "tan3")) +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA),
#axis.text.y = element_blank(), axis.ticks.y = element_blank(),
axis.text.x = element_blank(), axis.ticks.x = element_blank(), panel.spacing = unit(-0.2, "lines"))
ggplot(data = cytokine_rfp_melt, aes(x = Status, y = log2(value))) +
geom_boxplot(aes(fill = Status), outlier.colour = "white") +
geom_jitter(width = 0.2, aes(alpha = 0.3, shape = Status)) +
facet_wrap(. ~ variable, nrow = 1) +
scale_fill_manual(values=c("turquoise3", "tan3")) +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA),
#axis.text.y = element_blank(), axis.ticks.y = element_blank(),
legend. position = "none",
axis.text.x = element_blank(), axis.ticks.x = element_blank(), panel.spacing = unit(-0.2, "lines"))
ggplot(data = cytokine_rfp_melt, aes(x = Status, y = log2(value))) +
geom_boxplot(aes(fill = Status), outlier.colour = "white") +
geom_jitter(width = 0.2, aes(alpha = 0.3, shape = Status)) +
facet_wrap(. ~ variable, nrow = 1) +
scale_fill_manual(values=c("turquoise3", "tan3")) +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA),
#axis.text.y = element_blank(), axis.ticks.y = element_blank(),
legend.position="none",
axis.text.x = element_blank(), axis.ticks.x = element_blank(), panel.spacing = unit(-0.2, "lines"))
ggplot(data = cytokine_rfp_melt, aes(x = Status, y = log2(value))) +
geom_boxplot(aes(fill = Status), outlier.colour = "white") +
geom_jitter(width = 0.2, aes(alpha = 0.3, shape = Status)) +
facet_wrap(. ~ variable, nrow = 1) +
scale_fill_manual(values=c("turquoise3", "tan3")) +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA),
#axis.text.y = element_blank(), axis.ticks.y = element_blank(),
legend.position="none",
axis.text.x = element_blank(), axis.ticks.x = element_blank(), panel.spacing = unit(-0.3, "lines"))
ggplot(data = cytokine_rfp_melt, aes(x = Status, y = log2(value))) +
geom_boxplot(aes(fill = Status), outlier.colour = "white") +
geom_jitter(width = 0.2, aes(alpha = 0.3, shape = Status)) +
facet_wrap(. ~ variable, nrow = 1) +
scale_fill_manual(values=c("turquoise3", "tan3")) +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA),
#axis.text.y = element_blank(), axis.ticks.y = element_blank(),
legend.position="none",
axis.text.x = element_blank(), axis.ticks.x = element_blank(), panel.spacing = unit(-0.1, "lines"))
ggplot(data = cytokine_rfp_melt, aes(x = Status, y = log2(value))) +
geom_boxplot(aes(fill = Status), outlier.colour = "white") +
geom_jitter(width = 0.2, aes(alpha = 0.3, shape = Status)) +
facet_wrap(. ~ variable, nrow = 1) +
scale_fill_manual(values=c("turquoise3", "tan3")) +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA),
#axis.text.y = element_blank(), axis.ticks.y = element_blank(),
legend.position="none",
axis.text.x = element_blank(), axis.ticks.x = element_blank(), panel.spacing = unit(-0.05, "lines"))
ggplot(data = cytokine_rfp_melt, aes(x = Status, y = log2(value))) +
geom_boxplot(aes(fill = Status), outlier.colour = "white") +
geom_jitter(width = 0.2, aes(alpha = 0.3, shape = Status)) +
facet_wrap(. ~ variable, nrow = 1) +
scale_fill_manual(values=c("turquoise3", "tan3")) +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA),
#axis.text.y = element_blank(), axis.ticks.y = element_blank(),
legend.position="none",
axis.text.x = element_blank(), axis.ticks.x = element_blank(), panel.spacing = unit(0, "lines"))
gfMod <- readRDS(file = "gfMod.rds")
colnames(gfMod$B) <- colnames(cytokines_mpn)
Lasso_data <- gfMod$B[abs(rowSums(gfMod$B)) > 0.3, ]
rownames(Lasso_data) <- sapply(strsplit(rownames(Lasso_data), '_g_'), getElement, 2)
pheatmap(Lasso_data, show_rownames = T)
heatmap(Lasso_data, scale = "row", col=viridis(40), margins = c(4,15))
heatmap(Lasso_data, scale = "row", col=viridis(40), margins = c(4,15))
pheatmap(Lasso_data, show_rownames = T)
pheatmap(Lasso_data, show_rownames = T)
dev.off()
pheatmap(Lasso_data, show_rownames = T)
heatmap(Lasso_data, scale = "row", col=viridis(40), margins = c(4,15))
ggplot(data = cyto_otu, aes(y = tn_fa, x = lactobacillus)) +
geom_point()
ggplot(data = cyto_otu, aes(y = tn_fa, x = veillonella)) +
geom_point()
cyto_otu %>% select(., tn_fa, 16:86) %>%
corrr::correlate(method = "pearson") %>%
corrr::focus(tn_fa) %>%
filter(abs(tn_fa) > 0.1) %>%
#mutate(rowname = factor(rowname, levels = rowname[order(Fiber)])) %>%
ggplot(aes(x = rowname, y = tn_fa)) +
geom_bar(stat = "identity") +
ylab("Correlation (R) with Fiber\n (Spearman)") +
xlab("Species") + theme_bw() + theme(axis.text.x = element_text(angle = 90)) +
coord_flip()
ggplot(data = cyto_otu, aes(y = tn_fa, x = prevotella)) +
geom_point()
ggplot(data = cyto_otu, aes(y = tn_fa, x = acidaminococcus)) +
geom_point()
cyto_otu %>% select(., tn_fa, 16:86) %>%
corrr::correlate(method = "spearman") %>%
corrr::focus(tn_fa) %>%
filter(abs(tn_fa) > 0.1) %>%
#mutate(rowname = factor(rowname, levels = rowname[order(Fiber)])) %>%
ggplot(aes(x = rowname, y = tn_fa)) +
geom_bar(stat = "identity") +
ylab("Correlation (R) with Fiber\n (Spearman)") +
xlab("Species") + theme_bw() + theme(axis.text.x = element_text(angle = 90)) +
coord_flip()
ggplot(data = cyto_otu, aes(y = tn_fa, x = butyricimonas)) +
geom_point()
ggplot(data = cyto_otu, aes(y = tn_fa, x = phascolarctobacterium)) +
geom_point()
library(rstaix)
library(rstatix)
cyto_otu %>% select(., tn_fa, 16:86) %>%
cor_test(method = "spearman", vars = "tn_fa")
tnf_cor <- cyto_otu %>% select(., tn_fa, 16:86) %>%
cor_test(method = "spearman", vars = "tn_fa")
tnf_cor <- tnf_cor %>% filter(., var1 == "tn_fa")
tnf_cor1 <- as.data.frame(p.adjust(tnf_cor$p, method = "fdr"))
View(tnf_cor1)
View(tnf_cor)
tnf_cor <- cyto_otu %>% #select(., tn_fa, 16:86) %>%
cor_test(method = "spearman", vars = "phascolarctobacterium")
tnf_cor <- tnf_cor %>% filter(., var1 == "phascolarctobacterium")
tnf_cor1 <- as.data.frame(p.adjust(tnf_cor$p, method = "fdr"))
View(tnf_cor1)
View(tnf_cor)
View(tnf_cor1)
View(tnf_cor)
View(tnf_cor1)
View(tnf_cor1)
View(tnf_cor)
ggplot(data = cyto_otu, aes(y = tn_fa, x = cyto_otu$k_bacteria_p_firmicutes_c_clostridia_o_clostridiales_f_christensenellaceae_g_christensenellaceae_s_christensenellaceae_3)) +
geom_point()
cytokines <- read.csv("Cytokines.txt", sep = "\t")
cytokines_mpn <- cytokines %>% filter(., Status == "MPN", Sample != "124", Sample != "65")
mpn_w_cytokine <- as.vector(unique(cytokines_mpn$Sample))
mpn_otu <- subset(otu_merged, otu_merged$Individual %in% mpn_w_cytokine)
rownames(mpn_otu) <- NULL
mpn_otu <- mpn_otu %>%
select(., Individual, 32:NCOL(.)) %>%
group_by(., Individual) %>%
summarise_all(funs(mean))
mpn_otu <- mpn_otu %>% `row.names<-`(., NULL) %>% column_to_rownames(var = "Individual") %>% clean_names()
mpn_otu <- mpn_otu[,(colSums(mpn_otu) > 2)]
cytokines_mpn <- cytokines_mpn[cytokines_mpn$Sample %in% rownames(mpn_otu), ]
cytokines_mpn <- cytokines_mpn %>% select(., 1, 3:NCOL(cytokines_mpn)) %>%
clean_names()
rownames(cytokines_mpn) <- cytokines_mpn$sample
cytokines_mpn$sample <- NULL
# check raw data
cyto_otu <- merge(cytokines_mpn, mpn_otu, by.x = "row.names", by.y = "row.names")
ggplot(data = cyto_otu, aes(y = tn_fa, x = cyto_otu$k_bacteria_p_firmicutes_c_clostridia_o_clostridiales_f_christensenellaceae_g_christensenellaceae_s_christensenellaceae_3)) +
geom_point()
ggplot(data = cyto_otu, aes(y = tn_fa, x = cyto_otu$k_bacteria_p_actinobacteria_c_coriobacteriia_o_coriobacteriales_f_coriobacteriaceae_g_collinsella_s_stercoris)) +
geom_point()
source("~/Google Drive/My Drive/Github/MPN_project/scripts/gen_basic_env_genus.R")
library(tidyverse)
library(corrplot)
library(pheatmap)
library(gflasso)
library(janitor)
library(viridis)
cytokines <- read.csv("Cytokines.txt", sep = "\t")
cytokines_mpn <- cytokines %>% filter(., Status == "MPN", Sample != "124", Sample != "65")
mpn_w_cytokine <- as.vector(unique(cytokines_mpn$Sample))
mpn_otu <- subset(otu_merged, otu_merged$Individual %in% mpn_w_cytokine)
rownames(mpn_otu) <- NULL
mpn_otu <- mpn_otu %>%
select(., Individual, 32:NCOL(.)) %>%
group_by(., Individual) %>%
summarise_all(funs(mean))
mpn_otu <- mpn_otu %>% `row.names<-`(., NULL) %>% column_to_rownames(var = "Individual") %>% clean_names()
mpn_otu <- mpn_otu[,(colSums(mpn_otu) > 2)]
cytokines_mpn <- cytokines_mpn[cytokines_mpn$Sample %in% rownames(mpn_otu), ]
cytokines_mpn <- cytokines_mpn %>% select(., 1, 3:NCOL(cytokines_mpn)) %>%
clean_names()
rownames(cytokines_mpn) <- cytokines_mpn$sample
cytokines_mpn$sample <- NULL
# check raw data
cyto_otu <- merge(cytokines_mpn, mpn_otu, by.x = "row.names", by.y = "row.names")
tnf_cor <- cyto_otu %>% select(., tn_fa, 16:86) %>%
cor_test(method = "spearman", vars = "tn_fa")
library(rstatix)
tnf_cor <- cyto_otu %>% select(., tn_fa, 16:86) %>%
cor_test(method = "spearman", vars = "tn_fa")
tnf_cor <- tnf_cor %>% filter(., var1 == "tn_fa")
tnf_cor1 <- as.data.frame(p.adjust(tnf_cor$p, method = "fdr"))
View(tnf_cor)
ggplot(data = cyto_otu, aes(y = tn_fa, x = parabacteroides)) +
geom_point()
tnf_cor <- cyto_otu %>% select(., tn_fa, 16:86) %>%
cor_test(method = "pearson", vars = "tn_fa")
tnf_cor <- tnf_cor %>% filter(., var1 == "tn_fa")
tnf_cor1 <- as.data.frame(p.adjust(tnf_cor$p, method = "fdr"))
View(tnf_cor1)
View(tnf_cor)
ggplot(data = cyto_otu, aes(y = tn_fa, x = veinolla)) +
geom_point()
ggplot(data = cyto_otu, aes(y = tn_fa, x = veillonella)) +
geom_point()
ggplot(data = cyto_otu, aes(y = tn_fa, x = acidaminococcus)) +
geom_point()
ggplot(data = cyto_otu, aes(y = tn_fa, x = prevotella)) +
geom_point()
ggplot(data = cyto_otu, aes(y = tn_fa, x = sutterella)) +
geom_point()
View(tnf_cor1)
tnf_cor <- rbind(tnf_cor, tnf_cor1)
tnf_cor <- cbind(tnf_cor, tnf_cor1)
View(tnf_cor)
ggplot(data = cyto_otu, aes(y = tn_fa, x = parabacteroides)) +
geom_point()
ggplot(data = cyto_otu, aes(y = tn_fa, x = sutterella)) +
geom_point()
ggplot(data = cyto_otu, aes(y = tn_fa, x = prevotella)) +
geom_point()
tnf_cor <- cyto_otu %>% select(., tn_fa, 16:86) %>%
cor_test(method = "spearman", vars = "tn_fa")
tnf_cor <- tnf_cor %>% filter(., var1 == "tn_fa")
tnf_cor1 <- as.data.frame(p.adjust(tnf_cor$p, method = "fdr"))
tnf_cor <- cbind(tnf_cor, tnf_cor1)
View(tnf_cor)
ggplot(data = cyto_otu, aes(y = tn_fa, x = parabacteroides)) +
geom_point()
tnf_cor <- cyto_otu %>% select(., tn_fa, parabacteroides, prevotella, sutterella) %>%
cor_test(method = "spearman", vars = "tn_fa")
tnf_cor <- tnf_cor %>% filter(., var1 == "tn_fa")
tnf_cor1 <- as.data.frame(p.adjust(tnf_cor$p, method = "fdr"))
tnf_cor <- cyto_otu %>% select(., tn_fa, 16:86) %>%
cor_test(method = "spearman", vars = "tn_fa")
tnf_cor <- tnf_cor %>% filter(., var1 == "tn_fa")
tnf_cor1 <- as.data.frame(p.adjust(tnf_cor$p, method = "fdr"))
tnf_cor <- cbind(tnf_cor, tnf_cor1)
View(tnf_cor)
NROW(tnf_cor1)
cytokine_rfp_melt %>% group_by(., Status) %>% summarise(., mean = mean(value))
cytokine_rfp_melt %>% group_by(., Status, variable) %>% summarise(., mean = mean(value))
cytokine_rfp_melt %>% group_by(., Status, variable) %>% summarise(., mean = mean(value)) %>% View()
ggplot(data = cytokine_rfp_melt, aes(x = Status, y = log2(value))) +
geom_boxplot(aes(fill = Status), outlier.colour = "white") +
geom_jitter(width = 0.2, aes(alpha = 0.3, shape = Status)) +
facet_wrap(. ~ variable, nrow = 1) +
scale_fill_manual(values=c("turquoise3", "tan3")) +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA),
#axis.text.y = element_blank(), axis.ticks.y = element_blank(),
legend.position="none",
axis.text.x = element_blank(), axis.ticks.x = element_blank(), panel.spacing = unit(0, "lines"))
library(ggpubr)
ggplot(data = cytokine_rfp_melt, aes(x = Status, y = log2(value))) +
geom_boxplot(aes(fill = Status), outlier.colour = "white") +
geom_jitter(width = 0.2, aes(alpha = 0.3, shape = Status)) +
facet_wrap(. ~ variable, nrow = 1) +
scale_fill_manual(values=c("turquoise3", "tan3")) +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA),
#axis.text.y = element_blank(), axis.ticks.y = element_blank(),
legend.position="none",
axis.text.x = element_blank(), axis.ticks.x = element_blank(), panel.spacing = unit(0, "lines")) +
stat_compare_means(method = "kruskall")
ggplot(data = cytokine_rfp_melt, aes(x = Status, y = log2(value))) +
geom_boxplot(aes(fill = Status), outlier.colour = "white") +
geom_jitter(width = 0.2, aes(alpha = 0.3, shape = Status)) +
facet_wrap(. ~ variable, nrow = 1) +
scale_fill_manual(values=c("turquoise3", "tan3")) +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA),
#axis.text.y = element_blank(), axis.ticks.y = element_blank(),
legend.position="none",
axis.text.x = element_blank(), axis.ticks.x = element_blank(), panel.spacing = unit(0, "lines")) +
stat_compare_means(method = "kruskall",comparisons = c("Healthy", "MPN") )
ggplot(data = cytokine_rfp_melt, aes(x = Status, y = log2(value))) +
geom_boxplot(aes(fill = Status), outlier.colour = "white") +
geom_jitter(width = 0.2, aes(alpha = 0.3, shape = Status)) +
facet_wrap(. ~ variable, nrow = 1) +
scale_fill_manual(values=c("turquoise3", "tan3")) +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA),
#axis.text.y = element_blank(), axis.ticks.y = element_blank(),
legend.position="none",
axis.text.x = element_blank(), axis.ticks.x = element_blank(), panel.spacing = unit(0, "lines")) +
stat_compare_means(method = "kruskal.test",comparisons = c("Healthy", "MPN") )
ggplot(data = cytokine_rfp_melt, aes(x = Status, y = log2(value))) +
geom_boxplot(aes(fill = Status), outlier.colour = "white") +
geom_jitter(width = 0.2, aes(alpha = 0.3, shape = Status)) +
facet_wrap(. ~ variable, nrow = 1) +
scale_fill_manual(values=c("turquoise3", "tan3")) +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA),
#axis.text.y = element_blank(), axis.ticks.y = element_blank(),
legend.position="none",
axis.text.x = element_blank(), axis.ticks.x = element_blank(), panel.spacing = unit(0, "lines")) +
stat_compare_means(method = "kruskal.test")
ggplot(data = cytokine_rfp_melt, aes(x = Status, y = log2(value))) +
geom_boxplot(aes(fill = Status), outlier.colour = "white") +
geom_jitter(width = 0.2, aes(alpha = 0.3, shape = Status)) +
facet_wrap(. ~ variable, nrow = 1) +
scale_fill_manual(values=c("turquoise3", "tan3")) +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA),
#axis.text.y = element_blank(), axis.ticks.y = element_blank(),
legend.position="none",
axis.text.x = element_blank(), axis.ticks.x = element_blank(), panel.spacing = unit(0, "lines")) +
stat_compare_means(method = "kruskal.test", symnum.args = T)
ggplot(data = cytokine_rfp_melt, aes(x = Status, y = log2(value))) +
geom_boxplot(aes(fill = Status), outlier.colour = "white") +
geom_jitter(width = 0.2, aes(alpha = 0.3, shape = Status)) +
facet_wrap(. ~ variable, nrow = 1) +
scale_fill_manual(values=c("turquoise3", "tan3")) +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA),
#axis.text.y = element_blank(), axis.ticks.y = element_blank(),
legend.position="none",
axis.text.x = element_blank(), axis.ticks.x = element_blank(), panel.spacing = unit(0, "lines")) +
stat_compare_means(method = "kruskal.test")
ggplot(data = cytokine_rfp_melt, aes(x = Status, y = log2(value))) +
geom_boxplot(aes(fill = Status), outlier.colour = "white") +
geom_jitter(width = 0.2, aes(alpha = 0.3, shape = Status)) +
facet_wrap(. ~ variable) +
scale_fill_manual(values=c("turquoise3", "tan3")) +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA),
#axis.text.y = element_blank(), axis.ticks.y = element_blank(),
legend.position="none",
axis.text.x = element_blank(), axis.ticks.x = element_blank(), panel.spacing = unit(0, "lines")) +
stat_compare_means(method = "kruskal.test")
ggplot(data = cytokine_rfp_melt, aes(x = Status, y = value)) +
geom_boxplot(aes(fill = Status), outlier.colour = "white") +
geom_jitter(width = 0.2, aes(alpha = 0.3, shape = Status)) +
facet_wrap(. ~ variable) +
scale_fill_manual(values=c("turquoise3", "tan3")) +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA),
#axis.text.y = element_blank(), axis.ticks.y = element_blank(),
legend.position="none",
axis.text.x = element_blank(), axis.ticks.x = element_blank(), panel.spacing = unit(0, "lines")) +
stat_compare_means(method = "kruskal.test")
ggplot(data = cytokine_rfp_melt, aes(x = Status, y = log2(value))) +
geom_boxplot(aes(fill = Status), outlier.colour = "white") +
geom_jitter(width = 0.2, aes(alpha = 0.3, shape = Status)) +
facet_grid(. ~ variable) +
scale_fill_manual(values=c("turquoise3", "tan3")) +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.background = element_blank(),
panel.border = element_rect(colour = "black", fill = NA),
#axis.text.y = element_blank(), axis.ticks.y = element_blank(),
legend.position="none",
axis.text.x = element_blank(), axis.ticks.x = element_blank(), panel.spacing = unit(0, "lines")) #+
